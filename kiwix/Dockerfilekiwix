FROM ghcr.io/kiwix/kiwix-tools:latest
LABEL org.opencontainers.image.source=https://github.com/openzim/kiwix-tools

EXPOSE 8080
VOLUME /data
WORKDIR /data

# running as a named unprivileged user
RUN addgroup -S -g 1001 user && adduser -S -u 1001 user -G user
RUN chown user:user /data
USER user

# COPY the script that is already executable on the host
COPY ./kiwix/kiwixstart.sh /usr/local/bin/


ENTRYPOINT ["/usr/bin/dumb-init", "--", "/usr/local/bin/kiwixstart.sh"]
